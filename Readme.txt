Простое клиент-серверное приложение, работающее по htttps протоколу. С сервера на клиент передаются текстовые, html и графические файйлы.
Сначала необходимо запустить сервер. Находясь в корневой директории проекта, перейти в папку server/ и выполнить команды:
$cmake -S . -B build/
$cmake --build build/
Далее запустить сервер:
$./build/http-server <номер порта>
Далее необходимо запустить клиент. Для этого, находясь в корневой директории проекта, перейти в папку client/ и выполнить команды:
$cmake -S . -B build/
$cmake --build build/
Далее запустить клиент:
$./build/http-client <ip-адрес> <номер порта>
Здесь для локальной машины ip-адрес может вводиться в виде "127.0.0.1" либо "localhost".
Появляется информация об SSL-сертификате:
$Verifying /C=RU/ST=Some-State/O=Internet Widgits Pty Ltd/CN=localhost/emailAddress=agar10@yandex.ru
и строка с предложением ввода URI запрашиваемого на сервере ресурса:
$Enter URI:
Все файлы ресурсов хранятся в папке server/data/. В подпапке server/data/images хранятся изображения, а в server/data/text - текстовые файлы.
Например, вводим:
$Enter URI:/data/images/1.jpg
Сервер должен передать клиенту этот файл и сохранить его в папке клиента в выходной файл received.jpg (расширение такое же).
Далее, этот файл можно открыть, например, с помощью okular.
Если нужно передать текстовый файл (таблица из 2 колонок), то вводим:
$Enter URI:/data/text/data.txt

Клиент способен осуществлять только 1 вызов за раз. Сделать так, чтобы клиентские вызовы следовали один за другим (как в цикле while, внутри которого создаётся и уничтожается локальный объект
client c(io_context, ctx, iterator, std::string(argv[1]), OnDataReceived, OnRequestCompleted); либо же чередовать операции записи-чтения для клиента, как у асинхронного сервера), у меня в случае https протокола, к сожалению, так и не получилось.

Приложение исправно работает, доставляя файлы из папки server/data c сервера на клиент, но иногда происходит зависание клиента на строке boost::asio::async_read(...) функции ReadData() (поэтому пришлось добавить заглушку для текстовых файлов в строках 140-148 client.cpp, иначе для текстовых происходило зависание в этом месте). Сколько ни боролся, не смог победить этот баг.
Если клиент "убить" при помощи Ctrl+C, то доставленный файл лежить в папке и всё хорошо. Но сколько ни бился, не смог понять как исправить это зависание. Был бы благодарен за помощь с этим вопросом.

При нормальной работе приложения клиент должен завершаться сам после 1 запроса на сервер и получения то него ответа (в крайнем случае, его можно "убить" при помощи Ctrl+C).

Сервер можно остановить нажатием Ctrl+C в терминале, где он открыт, либо отправкой с клиента одной из команд (регистр не имеет букв значения):
SERVER SHUTDOWN
SERVER EXIT
SERVER STOP
SERVER FINISH





Как сгенерировать самоподписывающийся сертификат SSL?
Эти команды запускаются в папке сервера:
$openssl genrsa -des3 -out server.key 2048
$openssl req -new -key server.key -out server.csr
$openssl x509 -req -days 3650 -in server.csr -signkey server.key -out server.crt
$cp server.key server.key.secure
$openssl rsa -in server.key.secure -out server.key
$openssl dhparam -out dh2048.pem 2048
(с небольшими модификациями заимствованы отсюда: https://stackoverflow.com/questions/6452756/exception-running-boost-asio-ssl-example/8407739#8407739)

После этого в папке сервера остаются файлы: dh2048.pem, server.crt и все остальные, а в папку клиента необходимо скопировать файл server.crt.

